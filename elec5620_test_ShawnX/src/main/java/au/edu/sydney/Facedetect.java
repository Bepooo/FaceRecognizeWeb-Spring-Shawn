package au.edu.sydney;

import com.baidu.ai.aip.utils.HttpUtil;
import com.baidu.ai.aip.utils.Base64Util;
import com.baidu.ai.aip.utils.FileUtil;
import com.baidu.ai.aip.utils.GsonUtils;

import java.util.*;

/**
 * 人脸检测与属性分析
 */
public class Facedetect {

	/**
	 * 重要提示代码中所需工具类 FileUtil,Base64Util,HttpUtil,GsonUtils请从
	 * https://ai.baidu.com/file/658A35ABAB2D404FBF903F64D47C1F72
	 * https://ai.baidu.com/file/C8D81F3301E24D2892968F09AE1AD6E2
	 * https://ai.baidu.com/file/544D677F5D4E4F17B4122FBD60DB82B3
	 * https://ai.baidu.com/file/470B3ACCA3FE43788B5A963BF0B625F3 下载
	 * 
	 * @return
	 */
	public static String detect(String n) {
		// 请求url
		String url = "https://aip.baidubce.com/rest/2.0/face/v3/detect";
		System.out.println("get into face detect");
		try {
			byte[] bytes1 = FileUtil.readFileByBytes(n);
			String image1 = Base64Util.encode(bytes1);
			Map<String, Object> map = new HashMap<>();
			// map.put("image","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");
			map.put("face_field", "faceshape,facetype");
			map.put("image", image1);
			// map.put("image_type", "BASE64");
			map.put("image_type", "BASE64");

			String param = GsonUtils.toJson(map);

			// 注意这里仅为了简化编码每一次请求都去获取access_token，线上环境access_token有过期时间，
			// 客户端可自行缓存，过期后重新获取。
			// String accessToken =
			// "24.936901e94eee6271964498fe78f714e0.2592000.1538380298.282335-11758176";
			String accessToken = "24.ac1d816795c040131e0736934b5991f6.2592000.1541559242.282335-11758176";
			String result = HttpUtil.post(url, accessToken, "application/json", param);
			System.out.println(result);
			String[] seperate1 = result.split("face_token");
			String[] seperate2 = seperate1[1].split(":");
			String[] seperate3 = seperate2[1].split(",");
			String facetoken = seperate3[0].substring(1, seperate3[0].length() - 1);
			System.out.println(facetoken);
			return facetoken;
			// return result;
		} catch (Exception e) {
			e.printStackTrace();
		}

		return null;
	}

}